<element name="racer-collection" extends="racer-element">
  <template>
    <style>
      @host {}
    </style>  
    <smart-collection id="collection"></smart-collection>
  </template>
  <script>
    Polymer.register(this, {
      onItemDelete: function(id) {
        this.$.collection.remove(id);
      },
      onItemCreate: function(id) {
        var wrapper = document.createElement("racer-element");

        if (!this.childType) throw new Error("childType was not declared");
        wrapper.child = document.createElement(this.childType);
        wrapper.model = this._model.at(id);
        wrapper.id = id;
        this.$.collection.appendChild(wrapper);
      },
      onItemUpdate: function(id, data) {
        this.$.collection.get(id).update(data);
      },
      onChange: function(id, data) {
        if (this.$.collection.get(id)) {
          if (data) {
            this.onItemUpdate(id, data);
          } else {
            this.onItemDelete(id);
          }
        } else {
          this.onItemCreate(id);
        }
      }
    });
  </script>
</element>
